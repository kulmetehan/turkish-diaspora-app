# N4.4 – News Zoekinterface

## Overzicht
- Zoekveld boven de nieuwsfeed om direct binnen de diaspora-nieuwsbron te zoeken.
- Resultaten komen uit `/api/v1/news/search` en vervangen tijdelijk de feedlijst, terwijl tabs/filterchips zichtbaar blijven.
- URL-contract uitgebreid met `q=<query>` in dezelfde hash-query als `feed` en `themes`.

## UX
1. **Zoekveld**  
   - Component: `NewsSearchBar` (wrapper rond `FloatingSearchBar`).  
   - Placeholder: “Zoek in diaspora nieuws…”.  
   - Clear-knop reset naar feedmodus.
2. **Zoekmodus-indicator**  
   - Kopie onder het zoekveld: “Zoekresultaten binnen de diaspora-feed…”.
   - Tabs en themachips blijven direct beschikbaar.
3. **Resultaten**  
   - `NewsList` toont dezelfde kaarten/skeletons.  
   - Lege staat: “Geen artikelen gevonden voor je zoekopdracht.”  
   - Fout staat: “Zoeken mislukt. Probeer het later opnieuw.” + retry.

## Dataflow
| Mode | Hook | Endpoint | Notes |
|------|------|----------|-------|
| Feed | `useNewsFeed` | `/api/v1/news?feed=<key>&themes=…` | 60s cache voor eerste pagina per feed. |
| Search | `useNewsSearch` | `/api/v1/news/search?q=<query>&limit=&offset=` | Debounce 350 ms, min length 2, geen caching. |

- Paginate via `limit=20` + `offset`. Load-more schakelt automatisch tussen feed of search hook.
- Search hits alleen gedeelde diaspora-index (back-end filtert `processing_state='classified'`).

## URL & Hash
- `#/news?feed=<key>&themes=<...>&q=<term>`  
  - `q` wordt getrimd; bij leegte wordt het param verwijderd.  
  - Hashchange synchroniseert feed, thema’s én zoekwaarde (back/forward werkt).
- Helperfuncties in `lib/routing/newsFeed.ts`:
  - `readNewsSearchQueryFromHash`, `writeNewsSearchQueryToHash`, `clearNewsSearchQueryFromHash`.

## State Model
- `searchQuery` wordt altijd bijgehouden; “zoekmodus” = `query.trim().length >= 2`.
- Zoekresultaten vervangen alleen de lijst + laadtoestanden; tabs/filters blijven actief.
- Clearing search reset de hookstate en verwijdert `q` uit de hash.

## Debounce & Performance
- Debounce 350 ms in `useNewsSearch`; abort controllers voor supersnel typen.
- Geen caching voor zoekresultaten → altijd live data.
- Feedhook blijft draaien (voor directe terugkeer) maar UI gebruikt uitsluitend één mode tegelijk.

## Testing
- `useNewsSearch.spec.tsx`: debounce, pagination, abort.  
- `NewsPage.spec.tsx`: hash sync (`feed`, `themes`, `q`), zoekmodus, lege staat copy.  
- `newsFeed.spec.ts`: routing helper coverage.


